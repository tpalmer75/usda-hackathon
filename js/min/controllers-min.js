angular.module("lunch.controllers",[]).controller("MainCtrl",function(e,n,i,s,a,o){var r=o.all();n.newSubmission={},n.formSubmitted=!1,n.currentPersonInfo={};var d=new Date;n.filteredDate=a("date")(d,"MMM dd, y");var t=!1;n.frequencyValues=[{name:"Weekly",id:52},{name:"Bi-weekly",id:26},{name:"2x per month",id:24},{name:"Monthly",id:12},{name:"Yearly",id:1}],n.newSubmission={children:[{firstName:"",middleInitial:"",lastName:""}],adults:[{firstName:"",middleInitial:"",lastName:""}],date:n.filteredDate,primaryWageEarner:null},n.showTooltip=function(){},n.addPerson=function(e){var i={firstName:"",middleInitial:"",lastName:""};switch(e){case"child":n.newSubmission.children.push(i);break;case"adult":n.newSubmission.adults.push(i)}},n.goBack=function(){window.history.back()},e.$on("$stateChangeSuccess",function(e,i){n.currentPerson=s.idx;var a=i.name;"adult-individual"===a?n.currentPersonInfo=n.newSubmission.adults[n.currentPerson]:"child-individual"===a&&(n.currentPersonInfo=n.newSubmission.children[n.currentPerson])}),n.goNext=function(e){if(e){switch(i.current.name){case"intro":i.go("legal");break;case"legal":i.go("sign");break;case"sign":i.go("programs");break;case"programs":i.go("child-add");break;case"child-add":i.go("child-individual",{idx:0});break;case"child-individual":if(n.currentPerson++,n.newSubmission.children[n.currentPerson])i.go("child-individual",{idx:n.currentPerson});else if(n.newSubmission.programs)i.go("contact");else{for(var s=!0,a=0;a<n.newSubmission.children.length;a++){var o=n.newSubmission.children[a].fosterChild,d=n.newSubmission.children[a].homelessMigrantRunaway;o||d||(s=!1)}s?i.go("contact"):i.go("adult-add")}break;case"adult-add":i.go("adult-individual",{idx:0});break;case"adult-individual":if(n.currentPerson++,n.newSubmission.adults[n.currentPerson])i.go("adult-individual",{idx:n.currentPerson});else{for(var l=0,u=0;u<n.newSubmission.adults.length;u++){var c=n.newSubmission.adults[u],m=n.newSubmission.adults[u].workIncomeAmount*n.newSubmission.adults[u].workIncomeFrequency;m>l&&m>0&&(l=m,n.newSubmission.primaryWageEarner=c.firstName)}i.go("household")}break;case"household":var h=n.newSubmission.children.length+n.newSubmission.adults.length;if(n.newSubmission.household!==h)return;i.go("contact");break;case"contact":i.go("ethnicity");break;case"ethnicity":i.go("finish"),console.log("should be starting"),t?(r.$update(n.newSubmission),console.log("updated")):(r.$add(n.newSubmission),console.log("pushed",n.newSubmission))}n.formSubmitted=!1,document.body.scrollTop=85}}});