angular.module("lunch.controllers",[]).controller("MainCtrl",function(e,n,i,a,s){n.newSubmission={},n.formSubmitted=!1,n.currentPersonInfo={},n.showModal=!1;var r=new Date;n.filteredDate=s("date")(r,"MMM dd, y"),n.frequencyValues=[{name:"Weekly",id:52},{name:"Bi-weekly",id:26},{name:"2x per month",id:24},{name:"Monthly",id:12},{name:"Yearly",id:1}],n.newSubmission={children:[{firstName:"",middleInitial:"",lastName:""}],adults:[{firstName:"",middleInitial:"",lastName:""}],date:n.filteredDate,primaryWageEarner:null},n.showTooltip=function(){},n.addPerson=function(e){var i={firstName:"",middleInitial:"",lastName:""};switch(e){case"child":n.newSubmission.children.push(i);break;case"adult":n.newSubmission.adults.push(i)}},n.goBack=function(){window.history.back()},e.$on("$stateChangeSuccess",function(e,i){n.currentPerson=a.idx;var s=i.name;"adult-individual"===s?n.currentPersonInfo=n.newSubmission.adults[n.currentPerson]:"child-individual"===s&&(n.currentPersonInfo=n.newSubmission.children[n.currentPerson])}),n.goNext=function(e){if(e){switch(i.current.name){case"intro":i.go("legal");break;case"legal":i.go("sign");break;case"sign":i.go("programs");break;case"programs":i.go("child-add");break;case"child-add":i.go("child-individual",{idx:0});break;case"child-individual":if(n.currentPerson++,n.newSubmission.children[n.currentPerson])i.go("child-individual",{idx:n.currentPerson});else if(n.newSubmission.programs)i.go("contact");else{for(var a=!0,s=0;s<n.newSubmission.children.length;s++){var r=n.newSubmission.children[s].fosterChild,o=n.newSubmission.children[s].homelessMigrantRunaway;r||o||(a=!1)}a?i.go("contact"):i.go("adult-add")}break;case"adult-add":i.go("adult-individual",{idx:0});break;case"adult-individual":if(n.currentPerson++,n.newSubmission.adults[n.currentPerson])i.go("adult-individual",{idx:n.currentPerson});else{for(var d=0,t=0;t<n.newSubmission.adults.length;t++){var l=n.newSubmission.adults[t],u=n.newSubmission.adults[t].workIncomeAmount*n.newSubmission.adults[t].workIncomeFrequency;u>d&&u>0&&(d=u,n.newSubmission.primaryWageEarner=l.firstName)}i.go("household")}break;case"household":var c=n.newSubmission.children.length+n.newSubmission.adults.length;if(n.newSubmission.household!==c)return;i.go("contact");break;case"contact":i.go("ethnicity");break;case"ethnicity":i.go("finish")}n.formSubmitted=!1,document.body.scrollTop=85}}});