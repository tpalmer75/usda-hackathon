angular.module("lunch.controllers",[]).controller("MainCtrl",function(e,n,i,a,r){n.newSubmission={},n.formSubmitted=!1,n.currentPersonInfo={};var s=new Date;n.filteredDate=r("date")(s,"MMM dd, y"),n.frequencyValues=[{name:"Weekly",id:52},{name:"Bi-weekly",id:26},{name:"2x per month",id:24},{name:"Monthly",id:12},{name:"Yearly",id:1}],n.newSubmission={children:[{firstName:"",middleInitial:"",lastName:""}],adults:[{firstName:"",middleInitial:"",lastName:""}],date:n.filteredDate,primaryWageEarner:null},n.showTooltip=function(){},n.addPerson=function(e){var i={firstName:"",middleInitial:"",lastName:""};switch(e){case"child":n.newSubmission.children.push(i);break;case"adult":n.newSubmission.adults.push(i)}},n.goBack=function(){window.history.back()},e.$on("$stateChangeSuccess",function(e,i){n.currentPerson=a.idx;var r=i.name;"adult-individual"===r?n.currentPersonInfo=n.newSubmission.adults[n.currentPerson]:"child-individual"===r&&(n.currentPersonInfo=n.newSubmission.children[n.currentPerson])}),n.goNext=function(e){if(e){switch(i.current.name){case"intro":i.go("legal");break;case"legal":i.go("sign");break;case"sign":i.go("programs");break;case"programs":i.go("child-add");break;case"child-add":i.go("child-individual",{idx:0});break;case"child-individual":if(n.currentPerson++,n.newSubmission.children[n.currentPerson])i.go("child-individual",{idx:n.currentPerson});else if(n.newSubmission.programs)i.go("contact");else{for(var a=!0,r=0;r<n.newSubmission.children.length;r++){var s=n.newSubmission.children[r].fosterChild,o=n.newSubmission.children[r].homelessMigrantRunaway;s||o||(a=!1)}a?i.go("contact"):i.go("adult-add")}break;case"adult-add":i.go("adult-individual",{idx:0});break;case"adult-individual":if(n.currentPerson++,n.newSubmission.adults[n.currentPerson])i.go("adult-individual",{idx:n.currentPerson});else{for(var t=0,d=0;d<n.newSubmission.adults.length;d++){var l=n.newSubmission.adults[d],u=n.newSubmission.adults[d].workIncomeAmount*n.newSubmission.adults[d].workIncomeFrequency;u>t&&u>0&&(t=u,n.newSubmission.primaryWageEarner=l.firstName)}i.go("household")}break;case"household":var c=n.newSubmission.children.length+n.newSubmission.adults.length;if(n.newSubmission.household!==c)return;i.go("contact");break;case"contact":i.go("ethnicity");break;case"ethnicity":i.go("finish")}n.formSubmitted=!1,document.body.scrollTop=85}}});